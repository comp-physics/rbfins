name: MATLAB Code Quality

on:
  push:
  pull_request:

jobs:
  lint:
    runs-on: ubuntu-latest
    name: MATLAB Lint
    steps:
      - uses: actions/checkout@v4
      
      - name: Set up MATLAB
        uses: matlab-actions/setup-matlab@v2
      
      - name: Run MATLAB Code Analyzer
        uses: matlab-actions/run-command@v2
        with:
          command: addpath('.github/scripts'); lint
      
      - name: Upload lint log
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: matlab-lint-log
          path: .github/scripts/lint.log
          if-no-files-found: ignore

  format:
    runs-on: ubuntu-latest
    name: MATLAB Format Check
    steps:
      - uses: actions/checkout@v4
      
      - name: Check MATLAB files exist
        run: |
          echo "üìù MATLAB Formatting Check"
          echo "=========================="
          echo "Found MATLAB files:"
          find src tests -name "*.m" | head -10
          echo ""
          echo "‚ÑπÔ∏è  Note: MBeautifier requires MATLAB Editor which is not available in CI."
          echo "üîß To format code locally, run:"
          echo "   git clone https://github.com/davidvarga/MBeautifier.git .github/scripts/MBeautifier"
          echo "   matlab -batch \"addpath('.github/scripts'); format_matlab_code\""
          echo ""
          echo "‚úÖ Formatting check completed (local formatting recommended)"
